%
%
%/******************************************************************************
% *filename:		jiekousheji.tex
% *author:  		synckey
% *version: 		v1.0
% *datetime:		2011-06-24 15:08:01
% *description:		接口设计
% *****************************************************************************/
\section{接口设计}
\subsection{公共接口}
\subsubsection{单链表}
单链表提供一组创建链表，往链表中增加条目，删除条目，和删除链表的接口。
链表的节点的数据结构为：

\begin{quote}
\begin{lstlisting}[language={C}]
struct sl_node {
	void * data;
	struct sl_node * next;
};
\end{lstlisting}
\end{quote}

链表的结构体为：
\begin{quote}
\begin{lstlisting}[language={C}]
struct slist{
	struct sl_node * head;
	struct sl_node * end;
	struct sl_node * blank;
        size_t length;
	size_t capacity;
	struct sl_node * memlist; 
};
\end{lstlisting}
\end{quote}

\paragraph{创建链表}
\codebox{\#include "slist.h"}{struct slist * mk\_slist(void *
			(*my\_alloc)(size\_t),\\[-30pt]
		 \begin{flushright}size\_t capacity)\end{flushright}}{创建的链表}
	\begin{compactdesc}
	\item[功能：]创建一个新的链表。
	\item[参数：]my\_alloc()用来分配内存的函数指针，capacity，链表的容量。
	\item[返回：]创建的链表
	\end{compactdesc}
\codebox{\#include "slist.h"}{struct slist * sl\_expand(struct slist *sl,\\[-30pt]
		 \begin{flushright}void * (my\_alloc) (size\_t),size\_t delta);
		 \end{flushright}}{指向链表的指针}
	\begin{compactdesc}
	\item[功能：]当预分配的内存不够用的时候增加链表容量
	\item[参数：]链表指针，分配内存的函数和增加的大小
	\item[返回：]指向链表的指针
	\end{compactdesc}
\codebox{\#include "slist.h"}{int append(void * data, struct slist * sl);}{若成功
	则为0，若没有内存1}
	\begin{compactdesc}
	\item[功能：]向链表尾部添加一个节点
	\item[参数：]data，要存放的数据指针。sl，操作的链表指针。
	\item[返回：]若成功则返回0，返回1表示内存不足，函数执行失败。
	\end{compactdesc}
\codebox{\#include "slist.h"}{void * pop(struct slist * sl);}{无}
	\begin{compactdesc}
	\item[功能：]从链表的头部弹出一个节点，并返回这个指向这个节点的指针。
	\item[参数：]链表指针
	\item[返回：]指向弹出节点的指针。
	\end{compactdesc}
\codebox{\#include "slist.h"}{int push(void * data, struct slist * sl);}{若成功
	则为0，若没有内存1}
	\begin{compactdesc}
	\item[功能：]在链表头部前面插入一个节点。
	\item[参数：]data，插入节点的数据指针，sl，操作的链表。
	\item[返回：]若成功则返回0，返回1表示内存不足，函数执行失败。
	\end{compactdesc}
\codebox{\#include "slist.h"}{void sl\_free(void (* my\_free)(void *),struct slist * sl);
		     }{若成功则为0，若没有内存1}
	\begin{compactdesc}
	\item[功能：]在链表头部前面插入一个节点。
	\item[参数：]data，插入节点的数据指针，sl，操作的链表。
	\item[返回：]若成功则返回0，返回1表示内存不足，函数执行失败。
	\end{compactdesc}


\subsection{内存管理模块向外提供的接口}
内存管理模块向外提供两个接口——内存申请函数和内存释放函数。
\paragraph{内存申请函数}
\codebox{\#include "dc\_mm.h"}
	{void * dc\_alloc(size\_t size)}{若成功返回分配内存的首地址，若出错则返
	回NULL}
	\begin{compactdesc}
	\item[参数：]size 的单位为字节，表示想要申请的字节数。
	\item[返回：]返回一个指向所分配空间的void类型指针。如果size为0，则返
	回NULL或一个可以被dc\_free()成功释放的一个特定的指针。
	\end{compactdesc}
\paragraph{内存释放函数}
\codebox{\#include "dc\_mm.h"}{void dc\_free(void * ptr)}{无返回值}
	\begin{compactdesc}
	\item[参数：]将要被释放的内存的首地址指针ptr。
	\item[返回：]无
	\item[说明：]dc\_free()释放由dc\_alloc()分配的内存。如果先前已经调用
		了dc\_free(ptr)，则产生未定义操作，可能产生严重后果。如果ptr
		为NULL，就什么也不做。 
	\end{compactdesc}

\subsection{缓存接口对外接口}

%
%/*********************************  END OF jiekousheji.tex  *********************************/
